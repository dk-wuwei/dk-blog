"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6929],{9283:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"leave-page-do-fetch","metadata":{"permalink":"/dk-blog/leave-page-do-fetch","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-11-xx-leave-page-do-fetch.md","source":"@site/blog/2022-11-xx-leave-page-do-fetch.md","title":"\u79bb\u5f00\u9875\u9762\u53d1\u8d77\u8bf7\u6c42","description":"\u9700\u6c42\u80cc\u666f","date":"2022-11-20T13:32:03.000Z","formattedDate":"2022\u5e7411\u670820\u65e5","tags":[{"label":"JavaScript","permalink":"/dk-blog/tags/java-script"}],"readingTime":3.195,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"leave-page-do-fetch","title":"\u79bb\u5f00\u9875\u9762\u53d1\u8d77\u8bf7\u6c42","authors":"DK","tags":["JavaScript"]},"nextItem":{"title":"Git \u504f\u79fb\u7b26\u53f7","permalink":"/dk-blog/character-offset"}},"content":"## \u9700\u6c42\u80cc\u666f\\n\\n\u7528\u6237\u9000\u51fa\u5f53\u524d\u9875\u9762\u65f6\uff0c\u4fee\u6539\u7684\u6570\u636e\u672a\u8fdb\u884c\u4fdd\u5b58\uff0c\u9700\u8981\u53d1\u9001\u63a5\u53e3\u8bf7\u6c42\u5b9e\u73b0\u81ea\u52a8\u4fdd\u5b58\u7684\u529f\u80fd\u3002\u7b80\u5355\u5206\u6790\u9700\u6c42\u53ef\u77e5\uff0c\u9000\u51fa\u9875\u9762\u5305\u542b **\u8def\u7531\u5207\u6362**\u548c**\u5173\u95ed\u6d4f\u89c8\u5668\u6807\u7b7e\u9875**\u4e24\u79cd\u60c5\u51b5\uff1a\\n\\n- \u8def\u7531\u5207\u6362\uff1a\u9879\u76ee\u4f7f\u7528 `Vue2` \u5f00\u53d1\uff0c\u79bb\u5f00\u9875\u9762\u65f6\u53ef\u4ee5\u5728 `beforeDestroy` \u94a9\u5b50\u51fd\u6570\u4e2d\u8c03\u7528\u63a5\u53e3\u5b9e\u73b0\u4fdd\u5b58\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e2a\u65b9\u6cd5\u53ea\u80fd\u5728\u8def\u7531\u5207\u6362\u5f53\u524d\u7ec4\u4ef6\u9500\u6bc1\u524d\u89e6\u53d1\uff0c\u65e0\u6cd5\u76d1\u542c\u5230\u6d4f\u89c8\u5668\u9875\u9762\u5173\u95ed\u7684\u60c5\u51b5\u3002\\n- \u5173\u95ed\u6d4f\u89c8\u5668\u6807\u7b7e\u9875\uff1a\u8003\u8651\u5728 `window.onunload` \u94a9\u5b50\u51fd\u6570\u4e2d\u53d1\u9001\u8bf7\u6c42\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n### \u8def\u7531\u5207\u6362\\n\\n\u8def\u7531\u5207\u6362\u65f6\uff0c\u5f53\u524d\u7ec4\u4ef6\u5c06\u4f1a\u88ab\u9500\u6bc1\uff0c\u7531\u4e8e `beforeDestroy` \u94a9\u5b50\u51fd\u6570\u662f\u5728\u7ec4\u4ef6\u9500\u6bc1\u524d\u88ab\u8c03\u7528\uff0c\u53ef\u4ee5\u76f4\u63a5\u62ff\u5230\u5f53\u524d\u7ec4\u4ef6\u7684 `data`\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728 `beforeDestroy` \u94a9\u5b50\u51fd\u6570\u4e2d\u76f4\u63a5\u4f7f\u7528 `axios` \u53bb\u8c03\u7528\u63a5\u53e3\uff0c\u4fdd\u5b58\u6570\u636e\u3002\\n\\n\u8def\u7531\u5207\u6362\u65f6\u8c03\u7528\u63a5\u53e3\u4fdd\u5b58\u6570\u636e\u7684\u65b9\u5f0f\u7b80\u5355\uff0c\u4e0d\u505a\u8fc7\u591a\u8d58\u8ff0\u3002\\n\\n### \u5173\u95ed\u6d4f\u89c8\u5668\u6807\u7b7e\u9875\\n\\n### \u8bf7\u6c42\u65f6\u673a\uff1a\\n\\n\u56de\u987e\u4e00\u4e0b\u6d4f\u89c8\u5668\u52a0\u8f7d\u3001\u5237\u65b0\u3001\u5378\u8f7d\uff08\u5173\u95ed\uff09\u65f6\u89e6\u53d1\u7684\u4e8b\u4ef6\uff1a\\n\\n- \u52a0\u8f7d\u65f6\uff1a\u89e6\u53d1 `onload` \u4e8b\u4ef6\\n- \u5237\u65b0\u65f6\uff1a\u5148\u89e6\u53d1 `onbeforeunload` \u4e8b\u4ef6\uff0c\u7136\u540e\u662f `onunload` \u4e8b\u4ef6\uff0c\u6700\u540e\u662f `onload` \u4e8b\u4ef6\u3002\\n- \u5378\u8f7d\u65f6\uff1a\u5148\u89e6\u53d1 `onbeforeunload` \u4e8b\u4ef6\uff0c\u7136\u540e\u662f `onunload` \u4e8b\u4ef6\\n\\n**\u5237\u65b0\u548c\u5378\u8f7d\u9875\u9762\u65f6\u90fd\u4f1a\u5148\u540e\u89e6\u53d1 onbeforeunload \u548c onunload \u4e8b\u4ef6\uff0c\u4f46\u5237\u65b0\u9875\u9762\u7684\u65f6\u5019\u65f6\u4e0d\u9700\u8981\u8c03\u7528\u63a5\u53e3\u7684\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u533a\u5206\u5237\u65b0\u548c\u5173\u95ed\u884c\u4e3a\u3002**\\n\\n**\u6839\u636e\u65f6\u95f4\u5dee\u6765\u5b9e\u73b0\u5224\u65ad\u662f\u5237\u65b0\u8fd8\u662f\u5173\u95ed\u6807\u7b7e**\uff1a\\n\\n\u5728\u70b9\u51fb\u5237\u65b0\u6216\u8005\u5173\u95ed\u65f6\u5f00\u59cb\u8ba1\u65f6\u8bb0\u5f55\u4e0b\u8fd9\u4e00\u523b\u7684\u65f6\u95f4\u6233\uff0c\u56e0\u4e3a\u5237\u65b0\u548c\u5173\u95ed \u5728\u6267\u884c onunload \u65b9\u6cd5\u65f6\u7684\u65f6\u95f4\u4e0d\u4e00\u6837\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u7ecf\u8fc7\u6d4b\u8bd5\uff1a\\n\\n- **\u5173\u95ed\u65f6\u65f6\u95f4\u5dee\u4e0d\u5927\u4e8e 3 \u6beb\u79d2**\\n- **\u5237\u65b0\u65f6\u5373\u4f7f\u53ea\u6709\u4e00\u4e2a\u7b80\u5355\u7684 helloworld \u9875\u9762\u90fd\u4e0d\u5c11\u4e8e 10 \u6beb\u79d2**\\n- **\u800c\u4e00\u822c\u7f51\u7ad9\u7f51\u9875\u5185\u5bb9\u66f4\u591a\uff0c\u65f6\u95f4\u5dee\u8fbe\u5230\u4e86 100 \u591a\u6beb\u79d2**\\n\\n## demo\ud83c\udf30\uff1a\\n\\n```tsx\\n<!DOCTYPE html>\\n<html lang=\\"en\\">\\n  <head>\\n    <meta charset=\\"UTF-8\\" />\\n    <meta http-equiv=\\"X-UA-Compatible\\" content=\\"IE=edge\\" />\\n    <meta name=\\"viewport\\" content=\\"width=device-width, initial-scale=1.0\\" />\\n    <title>Document</title>\\n  </head>\\n  <body>\\n    <script>\\n      let beginTime = 0\\n      let differTime = 0\\n      window.onbeforeunload = function () {\\n        beginTime = new Date().getTime()\\n      }\\n\\n      window.onunload = function () {\\n        differTime = new Date().getTime() - beginTime\\n        // \u5173\u95ed\u9875\u9762\u64cd\u4f5c\\n        if (differTime < 5) {\\n          var blob = new Blob([\'room_id=123\'], {\\n            type: \'application/x-www-form-urlencoded\'\\n          })\\n\\n          navigator.sendBeacon(\'http://127.0.0.1:8686\', blob)\\n        }\\n      }\\n    <\/script>\\n  </body>\\n</html>\\n```\\n\\n### \u7b2c\u4e8c\u79cd\u65b9\u6848\\n\\n```tsx\\ndocument.addEventListener(\'visibilitychange\', () => {\\n  let isHidden = document.hidden\\n  if (isHidden) {\\n    this.saveCalculatorRecord()\\n    this.againGetCalculatorRecord = new Date().getTime()\\n  }\\n})\\n```\\n\\n## \u6ce8\u610f\uff1a\\n\\n\u5728app\u4e2d\u9700\u8981\u539f\u751f\u66b4\u9732\u51fa\u63a5\u53e3"},{"id":"character-offset","metadata":{"permalink":"/dk-blog/character-offset","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-11-15-character-offset.md","source":"@site/blog/2022-11-15-character-offset.md","title":"Git \u504f\u79fb\u7b26\u53f7","description":"\u5728 Git \u4e2d\uff0c\u6709\u4e24\u4e2a\u300c\u504f\u79fb\u7b26\u53f7\u300d: ^ \u548c ~\u3002","date":"2022-11-15T00:00:00.000Z","formattedDate":"2022\u5e7411\u670815\u65e5","tags":[{"label":"Git","permalink":"/dk-blog/tags/git"}],"readingTime":0.82,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"character-offset","title":"Git \u504f\u79fb\u7b26\u53f7","authors":"DK","tags":["Git"]},"prevItem":{"title":"\u79bb\u5f00\u9875\u9762\u53d1\u8d77\u8bf7\u6c42","permalink":"/dk-blog/leave-page-do-fetch"},"nextItem":{"title":"margin\u548cpadding\u7684\u533a\u522b\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528","permalink":"/dk-blog/margin-padding"}},"content":"\u5728 Git \u4e2d\uff0c\u6709\u4e24\u4e2a\u300c\u504f\u79fb\u7b26\u53f7\u300d: `^` \u548c `~`\u3002\\n\\n## \u4e00\u3001^ \u7684\u7528\u6cd5: \\n\\n\u5728 `commit` \u7684\u540e\u9762\u52a0\u4e00\u4e2a\u6216\u591a\u4e2a `^` \u53f7\uff0c\u53ef\u4ee5 \u628a `commit` \u5f80\u56de\u504f\u79fb\uff0c\u504f\u79fb\u7684\u6570\u91cf\u662f `^` \u7684\u6570\u91cf\u3002\u4f8b \u5982: `master^` \u8868\u793a `master` \u6307\u5411\u7684 `commit` \u4e4b\u524d\u7684\u90a3 \u4e2a `commit`; `HEAD^^` \u8868\u793a `HEAD` \u6240\u6307\u5411\u7684 `commit` \u5f80 \u524d\u6570\u4e24\u4e2a `commit`\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n```shell\\ngit rebase -i HEAD^^\\n```\\n\\n\u4e0a\u9762\u8fd9\u884c\u4ee3\u7801\u8868\u793a\uff0c\u628a\u5f53\u524d `commit` ( `HEAD` \u6240\u6307\u5411\u7684 `commit`) `rebase` \u5230 `HEAD` \u4e4b\u524d 2 \u4e2a\u7684 `commit` \u4e0a:\\n\\n![](https://gitee.com/dk-wuwei/note-resource/raw/master/image/202211080816919.png)\\n\\n## \u4e8c\u3001~ \u7684\u7528\u6cd5:\\n\\n\u5728 `commit` \u7684\u540e\u9762\u52a0\u4e0a `~` \u53f7\u548c\u4e00\u4e2a\u6570\uff0c\u53ef\u4ee5 \u628a `commit` \u5f80\u56de\u504f\u79fb\uff0c\u504f\u79fb\u7684\u6570\u91cf\u662f `~` \u53f7\u540e\u9762\u7684\u6570\u3002\u4f8b\u5982: `HEAD~5` \u8868\u793a `HEAD` \u6307\u5411\u7684 `commit` \u5f80\u524d\u6570 5 \u4e2a `commit`\u3002"},{"id":"margin-padding","metadata":{"permalink":"/dk-blog/margin-padding","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-10-21-margin-padding.md","source":"@site/blog/2022-10-21-margin-padding.md","title":"margin\u548cpadding\u7684\u533a\u522b\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528","description":"\u9996\u5148\u9700\u8981\u660e\u767d\uff0c\u76d2\u5b50\u6a21\u578b\u4e3b\u8981\u5b9a\u4e49\u56db\u4e2a\u533a\u57df\uff1a\u5185\u5bb9\uff08content\uff09\u3001\u8fb9\u6846\u4e0e\u5185\u5bb9\u7684\u533a\u57df\uff0c\u79f0\u4e3a\u5185\u8fb9\u8ddd\uff08padding\uff09\u3001\u8fb9\u6846\uff08border\uff09\u3001\u8fb9\u6846\u4e0e\u5916\u90e8\u7684\u533a\u57df\uff0c\u79f0\u4e3a\u5916\u8fb9\u8ddd\uff08margin\uff09\u3002","date":"2022-10-21T00:00:00.000Z","formattedDate":"2022\u5e7410\u670821\u65e5","tags":[{"label":"CSS","permalink":"/dk-blog/tags/css"}],"readingTime":2.235,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"margin-padding","title":"margin\u548cpadding\u7684\u533a\u522b\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528","authors":"DK","tags":["CSS"]},"prevItem":{"title":"Git \u504f\u79fb\u7b26\u53f7","permalink":"/dk-blog/character-offset"},"nextItem":{"title":"useReducer","permalink":"/dk-blog/use-reducer"}},"content":"\u9996\u5148\u9700\u8981\u660e\u767d\uff0c\u76d2\u5b50\u6a21\u578b\u4e3b\u8981\u5b9a\u4e49\u56db\u4e2a\u533a\u57df\uff1a\u5185\u5bb9\uff08`content`\uff09\u3001\u8fb9\u6846\u4e0e\u5185\u5bb9\u7684\u533a\u57df\uff0c\u79f0\u4e3a\u5185\u8fb9\u8ddd\uff08`padding`\uff09\u3001\u8fb9\u6846\uff08`border`\uff09\u3001\u8fb9\u6846\u4e0e\u5916\u90e8\u7684\u533a\u57df\uff0c\u79f0\u4e3a\u5916\u8fb9\u8ddd\uff08`margin`\uff09\u3002\\n\\n# \u533a\u522b\\n\\n\x3c!--truncate--\x3e\\n\\n- `margin`\uff1a\u8868\u793a\u8fb9\u6846\u4ee5\u5916\u7684\u533a\u57df\\n\\n- `padding`\uff1a\u8868\u793a\u8fb9\u6846\u4e0e\u5185\u5bb9\u4e4b\u95f4\u7684\u533a\u57df\\n\\n# \u4f7f\u7528\u573a\u666f\\n\\n## \u4f7f\u7528margin\u7684\u573a\u666f\uff1a\\n\\n- \u9700\u8981\u5728`border`\uff08\u8fb9\u6846\uff09\u4ee5\u5916\u7684\u533a\u57df\u6dfb\u52a0\u7a7a\u767d\u95f4\u8ddd\u65f6\uff1b\\n\\n- \u7a7a\u767d\u533a\u57df\u4e0d\u9700\u8981\u4f7f\u7528\u80cc\u666f\u989c\u8272\u65f6\\n\\n- \u9700\u8981\u4f7f\u7528\u8d1f\u503c\u5bf9\u9875\u9762\u5e03\u5c40\u65f6\uff08\u6ce8\u610f\uff1a`margin`\u7684\u503c\u53ef\u4ee5\u53d6\u8d1f\u6570\uff0c`padding`\u7684\u503c\u662f\u4e0d\u80fd\u4f7f\u8d1f\u6570\u7684\uff09\\n\\n**\u6ce8\u610f\uff1a**\\n> \u4e0a\u4e0b\u4e24\u4e2a\u76f8\u8fde\u7684\u76d2\u5b50\u4e4b\u95f4\u4f7f\u7528\u7684\u5916\u8fb9\u8ddd\u9700\u8981\u76f8\u4e92\u62b5\u6d88\u3002\\n> \\n> `margin`\u5728\u5782\u76f4\u65b9\u5411\u4e0a\u76f8\u90bb\u7684\u503c\u76f8\u540c\u65f6\u4f1a\u53d1\u751f\u53e0\u52a0\uff0c\u6c34\u5e73\u65b9\u5411\u7684\u503c\u4f1a\u76f8\u52a0\u3002`margin`\u53d6\u8d1f\u503c\u65f6\uff0c\u5728\u5782\u76f4\u65b9\u5411\u4e0a\uff0c\u4e24\u4e2a\u5143\u7d20\u7684\u8fb9\u754c\u4ecd\u7136\u4f1a\u91cd\u53e0\uff0c\u4f46\u662f\uff0c\u6b64\u65f6\u4e00\u4e2a\u4e3a\u6b63\u6570\uff0c\u4e00\u4e2a\u4e3a\u8d1f\u6570\uff0c\u5e76\u4e0d\u662f\u53d6\u5176\u4e2d\u8f83\u5927\u7684\u503c\uff0c\u800c\u662f\u7528\u8fb9\u754c\u7684\u7edd\u5bf9\u503c\uff0c\u4e5f\u5c31\u662f\u6b63\u7684\u8fb9\u754c\u503c\u548c\u8d1f\u7684\u8fb9\u754c\u503c\u76f8\u52a0\u3002\\n\\n \\n\\n# \u4f7f\u7528padding\u7684\u573a\u666f\uff1a\\n\\n- \u9700\u8981\u5728`border`\u5185\u4fa7\u6dfb\u52a0\u7a7a\u767d\\n\\n- \u7a7a\u767d\u533a\u57df\u9700\u8981\u4f7f\u7528\u5230\u80cc\u666f\u989c\u8272\\n\\n**\u6ce8\u610f\uff1a**\\n\\n> \u4e0a\u4e0b\u76f8\u8fde\u7684\u4e24\u4e2a\u76d2\u5b50\u4e4b\u95f4\u7684\u7a7a\u767d\uff0c\u95f4\u8ddd\u662f\u4e24\u8005\u4e4b\u548c\\n> \\n> \u6700\u540e\uff0c\u9700\u6ce8\u610f`margin`\u662f\u7528\u6765\u9694\u5f00\u5143\u7d20\u4e0e\u5143\u7d20\u7684\u95f4\u8ddd\uff1b`padding`\u662f\u7528\u6765\u9694> \u5f00\u5143\u7d20\u4e0e\u5185\u5bb9\u7684\u95f4\u8ddd\uff1b`margin`\u7528\u4e8e\u5e03\u5c40\u5206\u5f00\u5143\u7d20\uff0c\u4f7f\u5143\u7d20\u4e0e\u5143\u7d20\u4e92\u4e0d\u5e72> \u6270\uff1b`padding`\u7528\u4e8e\u5143\u7d20\u4e0e\u5185\u5bb9\u4e4b\u95f4\u95f4\u9694\uff0c\u8ba9\u5185\u5bb9\u4e0e\u5143\u7d20\u4e4b\u95f4\u6709\u4e00\u6bb5\u8ddd\u79bb\u3002\\n\\n## \u8865\u5145\\n\\n\u602a\u5f02\u76d2\u6a21\u578b\uff1a`content=content+padding+border`\\n\\n\u6807\u51c6\u76d2\u6a21\u578b\uff1a`content=content`\\n\\n\u5728\u602a\u5f02\u76d2\u6a21\u578b\u4e2d\uff0c\u4e00\u4e2a\u5757\u7684\u603b\u5bbd\u5ea6\u53d7`margin`\u5f71\u54cd\uff0c\u4f46\u4e0d\u53d7`padding`\u7684\u5f71\u54cd\u3002"},{"id":"use-reducer","metadata":{"permalink":"/dk-blog/use-reducer","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-10-12-use-reducer.md","source":"@site/blog/2022-10-12-use-reducer.md","title":"useReducer","description":"useReducer \u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a","date":"2022-10-12T00:00:00.000Z","formattedDate":"2022\u5e7410\u670812\u65e5","tags":[{"label":"React","permalink":"/dk-blog/tags/react"},{"label":"Hooks","permalink":"/dk-blog/tags/hooks"}],"readingTime":2.125,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"use-reducer","title":"useReducer","authors":"DK","tags":["React","Hooks"]},"prevItem":{"title":"margin\u548cpadding\u7684\u533a\u522b\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528","permalink":"/dk-blog/margin-padding"},"nextItem":{"title":"\u9002\u7528\u4e8eHTML\u7684\u7701\u7565\u53f7","permalink":"/dk-blog/ellipsis-for-html"}},"content":"useReducer \u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a\\n\\n\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1areducer \u51fd\u6570\uff0c\u6ca1\u9519\u5c31\u662f\u6211\u4eec\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4ecb\u7ecd\u7684\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u521d\u59cb\u5316\u7684 state\u3002\u8fd4\u56de\u503c\u4e3a\u6700\u65b0\u7684 state \u548c dispatch \u51fd\u6570\uff08\u7528\u6765\u89e6\u53d1 reducer \u51fd\u6570\uff0c\u8ba1\u7b97\u5bf9\u5e94\u7684 state\uff09\u3002\u6309\u7167\u5b98\u65b9\u7684\u8bf4\u6cd5\uff1a\u5bf9\u4e8e\u590d\u6742\u7684 state \u64cd\u4f5c\u903b\u8f91\uff0c\u5d4c\u5957\u7684 state \u7684\u5bf9\u8c61\uff0c\u63a8\u8350\u4f7f\u7528 useReducer\u3002\\n\\n\u542c\u8d77\u6765\u6bd4\u8f83\u62bd\u8c61\uff0c\u6211\u4eec\u5148\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a\\n\\n\x3c!--truncate--\x3e\\n\\n```js\\n// \u5b98\u65b9 useReducer Demo\\n// \u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u5e94\u7528\u7684\u521d\u59cb\u5316\\nconst initialState = { count: 0 }\\n\\n// \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1astate\u7684reducer\u5904\u7406\u51fd\u6570\\nfunction reducer(state, action) {\\n  switch (action.type) {\\n    case \'increment\':\\n      return { count: state.count + 1 }\\n    case \'decrement\':\\n      return { count: state.count - 1 }\\n    default:\\n      throw new Error()\\n  }\\n}\\n\\nfunction Counter() {\\n  // \u8fd4\u56de\u503c\uff1a\u6700\u65b0\u7684state\u548cdispatch\u51fd\u6570\\n  const [state, dispatch] = useReducer(reducer, initialState)\\n  return (\\n    <>\\n      // useReducer\u4f1a\u6839\u636edispatch\u7684action\uff0c\u8fd4\u56de\u6700\u7ec8\u7684state\uff0c\u5e76\u89e6\u53d1rerender\\n      Count: {state.count}\\n      // dispatch \u7528\u6765\u63a5\u6536\u4e00\u4e2a action\u53c2\u6570\u300creducer\u4e2d\u7684action\u300d\uff0c\u7528\u6765\u89e6\u53d1reducer\u51fd\u6570\uff0c\u66f4\u65b0\u6700\u65b0\u7684\u72b6\u6001\\n      <button onClick={() => dispatch({ type: \'increment\' })}>+</button>\\n      <button onClick={() => dispatch({ type: \'decrement\' })}>-</button>\\n    </>\\n  )\\n}\\n```\\n\\n# \u603b\u7ed3\\n\\n```js\\n// \u8fd4\u56de\u4e00\u4e2a newState (newObject)\\nfunction countReducer(state, action) {\\n    switch(action.type) {\\n        case \'add\':\\n            return { ...state, count: state.count + 1; }\\n        case \'sub\':\\n            return { ...state, count: state.count - 1; }\\n        default:\\n            return count;\\n    }\\n}\\n```\\n\\nuseReducer \u662f\u4e00\u4e2a\u5229\u7528 action \u63d0\u4f9b\u7684\u4fe1\u606f\uff0c\u5c06 state \u4ece A \u8f6c\u6362\u5230 B \u7684\u4e00\u4e2a\u7eaf\u51fd\u6570\uff0c\u5177\u6709\u4e00\u4e0b\u51e0\u4e2a\u7279\u70b9\uff1a\\n\\n- \u8bed\u6cd5\uff1a(state, action) => newState\\n- Immutable\uff1a\u6bcf\u6b21\u90fd\u8fd4\u56de\u4e00\u4e2a newState\uff0c \u6c38\u8fdc\u4e0d\u8981\u76f4\u63a5\u4fee\u6539 state \u5bf9\u8c61\\n- Action\uff1a\u4e00\u4e2a\u5e38\u89c4\u7684 Action \u5bf9\u8c61\u901a\u5e38\u6709 type \u548c payload\uff08\u53ef\u9009\uff09\u7ec4\u6210\\n  - type\uff1a \u672c\u6b21\u64cd\u4f5c\u7684\u7c7b\u578b\uff0c\u4e5f\u662f reducer \u6761\u4ef6\u5224\u65ad\u7684\u4f9d\u636e\\n  - payload\uff1a \u63d0\u4f9b\u64cd\u4f5c\u9644\u5e26\u7684\u6570\u636e\u4fe1\u606f"},{"id":"ellipsis-for-html","metadata":{"permalink":"/dk-blog/ellipsis-for-html","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-10-06-ellipsis-for-html.md","source":"@site/blog/2022-10-06-ellipsis-for-html.md","title":"\u9002\u7528\u4e8eHTML\u7684\u7701\u7565\u53f7","description":"\u8bbe\u7f6e\u5185\u5bb9\u663e\u793a\u591a\u5c11\u884c\uff0c\u591a\u4f59\u7684\u5185\u5bb9\u6dfb\u52a0\u7701\u7565\u53f7","date":"2022-10-06T00:00:00.000Z","formattedDate":"2022\u5e7410\u67086\u65e5","tags":[{"label":"HTML","permalink":"/dk-blog/tags/html"},{"label":"CSS","permalink":"/dk-blog/tags/css"}],"readingTime":0.23,"hasTruncateMarker":false,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"ellipsis-for-html","title":"\u9002\u7528\u4e8eHTML\u7684\u7701\u7565\u53f7","authors":"DK","tags":["HTML","CSS"]},"prevItem":{"title":"useReducer","permalink":"/dk-blog/use-reducer"},"nextItem":{"title":"JS\u7761\u7720\u51fd\u6570","permalink":"/dk-blog/js-sleep-function"}},"content":"\u8bbe\u7f6e\u5185\u5bb9\u663e\u793a\u591a\u5c11\u884c\uff0c\u591a\u4f59\u7684\u5185\u5bb9\u6dfb\u52a0\u7701\u7565\u53f7\\n\\n```scss\\n.ellipsis {\\n  overflow: hidden;\\n  display: -webkit-box;\\n  -webkit-box-orient: vertical;\\n  -webkit-line-clamp: 1;\\n  \\n/ / moz \u4e0d\u8bbe\u7f6e\u4e5f\u53ef\u4ee5 display:-moz-box;\\n  -moz-box-orient: vertical;\\n  -moz-line-clamp: 1;\\n}\\n```"},{"id":"js-sleep-function","metadata":{"permalink":"/dk-blog/js-sleep-function","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-09-28-js-sleep-function.md","source":"@site/blog/2022-09-28-js-sleep-function.md","title":"JS\u7761\u7720\u51fd\u6570","description":"","date":"2022-09-28T00:00:00.000Z","formattedDate":"2022\u5e749\u670828\u65e5","tags":[{"label":"JavaScript","permalink":"/dk-blog/tags/java-script"}],"readingTime":0.24,"hasTruncateMarker":false,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"js-sleep-function","title":"JS\u7761\u7720\u51fd\u6570","authors":"DK","tags":["JavaScript"]},"prevItem":{"title":"\u9002\u7528\u4e8eHTML\u7684\u7701\u7565\u53f7","permalink":"/dk-blog/ellipsis-for-html"},"nextItem":{"title":"mac webstorm\u5feb\u6377\u952e","permalink":"/dk-blog/webstorm-shortcut-key"}},"content":"```tsx\\n/**\\n * js\u7761\u7720\u51fd\u6570\\n * @param numberMillis {number} \u6beb\u79d2\u503c\\n * @returns {boolean}\\n */\\nfunction sleep (numberMillis) {\\n  let now = new Date();\\n  let exitTime = now.getTime() + numberMillis;\\n  while (true) {\\n    now = new Date();\\n    if (now.getTime() > exitTime)\\n      return true;\\n  }\\n}\\n```"},{"id":"webstorm-shortcut-key","metadata":{"permalink":"/dk-blog/webstorm-shortcut-key","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-09-26-webstorm-shortcut-key.md","source":"@site/blog/2022-09-26-webstorm-shortcut-key.md","title":"mac webstorm\u5feb\u6377\u952e","description":"\u8c03\u8bd5","date":"2022-09-26T00:00:00.000Z","formattedDate":"2022\u5e749\u670826\u65e5","tags":[{"label":"idea","permalink":"/dk-blog/tags/idea"}],"readingTime":3.73,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"webstorm-shortcut-key","title":"mac webstorm\u5feb\u6377\u952e","authors":"DK","tags":["idea"]},"prevItem":{"title":"JS\u7761\u7720\u51fd\u6570","permalink":"/dk-blog/js-sleep-function"},"nextItem":{"title":"Vue2\u89e3\u6790excel\u6570\u636e","permalink":"/dk-blog/first-blog"}},"content":"```html\\nCommand+alt+T \u7528 (if..else, try..catch, for, etc.)\u5305\u4f4f\\nCommand+/ \u6ce8\u91ca/\u53d6\u6d88\u6ce8\u91ca\u7684\u884c\u6ce8\u91ca\\nCommand+alt+/ \u6ce8\u91ca/\u53d6\u6d88\u6ce8\u91ca\u4e0e\u5757\u6ce8\u91ca\\nalt+\u2191 \u5411\u4e0a\u9009\u53d6\u4ee3\u7801\u5757\\nalt+\u2193 \u5411\u4e0b\u9009\u53d6\u4ee3\u7801\u5757\\nCommand+alt+L \u683c\u5f0f\u5316\u4ee3\u7801\\ntab,shift+tab \u8c03\u6574\u7f29\u8fdb\\nControl+alt+I \u5feb\u901f\u8c03\u6574\u7f29\u8fdb\\nCommand+C \u590d\u5236\\nCommand+X \u526a\u5207\\nCommand+V \u7c98\u8d34\\nCommand+shift+V \u4ece\u526a\u8d34\u677f\u91cc\u9009\u62e9\u7c98\u8d34\\nCommand+D \u590d\u5236\u4ee3\u7801\u526f\u672c\\nCommand+delete \u5220\u9664\u5f53\u524d\u884c\\nControl+Shift+J \u6e05\u9664\u7f29\u8fdb\u53d8\u6210\u5355\u884c\\nshift+\u56de\u8f66 \u5feb\u901f\u6362\u884c\\nCommand+\u56de\u8f66 \u6362\u884c\u5149\u6807\u8fd8\u5728\u539f\u5148\u4f4d\u7f6e\\nCommand+shift+U \u5927\u5c0f\u5199\u8f6c\u6362\\nCommand+shift+[,Command+shift+] \u6587\u4ef6\u9009\u9879\u5361\u5feb\u901f\u5207\u6362\\nCommand+\u52a0\u53f7,Command+\u51cf\u53f7 \u6536\u7f29\u4ee3\u7801\u5757\\nCommand+shift+\u52a0\u53f7\uff0cCommand+shift+\u51cf\u53f7 \u6536\u7f29\u6574\u4e2a\u6587\u6863\u7684\u4ee3\u7801\u5757\\nCommand+W \u5173\u95ed\u5f53\u524d\u6587\u4ef6\u9009\u9879\u5361\\nalt+\u5355\u51fb \u5149\u6807\u5728\u591a\u5904\u5b9a\u4f4d\\nControl+shift+J \u628a\u4e0b\u9762\u884c\u7684\u7f29\u8fdb\u6536\u4e0a\u6765\\nshift + F6 \u9ad8\u7ea7\u4fee\u6539\uff0c\u53ef\u5feb\u901f\u4fee\u6539\u5149\u6807\u6240\u5728\u7684\u6807\u7b7e\u3001\u53d8\u91cf\u3001\u51fd\u6570\u7b49\\nalt+/ \u4ee3\u7801\u8865\u5168\\n```\\n\x3c!--truncate--\x3e\\n\\n## \u8c03\u8bd5\\n```html\\nControl+alt+R \u8fd0\u884c\u9879\u76ee\\nCommand+Control+R \u8fd0\u884cDebug\\nCommand+F8 \u6dfb\u52a0\u65ad\u70b9\\nCommand+shift+F8 \u6253\u5f00\u65ad\u70b9\u5217\u8868\\n```\\n\\n## \u5bfc\u822a\\n```html\\nCommand+O \u8df3\u8f6c\u5230\u67d0\u4e2a\u7c7b\\nCommand+shift+O \u8df3\u8f6c\u5230\u67d0\u4e2a\u6587\u4ef6\\nCommand+alt+O \u8df3\u8f6c\u5230\u67d0\u4e2a\u7b26\u53f7\\nControl+\u2190,Control+\u2192 \u8f6c\u5230\u4e0a/\u4e0b\u4e00\u4e2a\u7f16\u8f91\u5668\u9009\u9879\u5361\\nF12 \u6253\u5f00\u4e4b\u524d\u6253\u5f00\u7684\u5de5\u5177\u7a97\u53e3\uff08TODO\u3001\u7ec8\u7aef\u7b49\uff09\\nCommand+L \u8df3\u8f6c\u884c\\nCommand+E \u5f39\u51fa\u6700\u8fd1\u6587\u4ef6\\nCommand+alt+\u2190,Command+alt+\u2192 \u5411\u524d\u5411\u540e\u5bfc\u822a\u5230\u4ee3\u7801\u5757\u4ea4\u63a5\u5904\uff08\u4e00\u822c\u662f\u7a7a\u884c\u5904\uff09\\nCommand+shift+delete \u5bfc\u822a\u5230\u4e0a\u4e00\u4e2a\u7f16\u8f91\u4f4d\u7f6e\u7684\u4f4d\u7f6e\\nCommand+B \u8df3\u8f6c\u5230\u53d8\u91cf\u58f0\u660e\u5904\\nControl+J \u83b7\u53d6\u53d8\u91cf\u76f8\u5173\u4fe1\u606f\uff08\u7c7b\u578b\u3001\u6ce8\u91ca\u7b49\uff0c\u6ce8\u91ca\u662f\u62ff\u4e0a\u4e00\u884c\u7684\u6ce8\u91ca\uff09\\nCommand+Y \u5c0f\u6d6e\u7a97\u663e\u793a\u53d8\u91cf\u58f0\u660e\u65f6\u7684\u884c\\nCommand+[,Command+] \u5149\u6807\u73b0\u5728\u7684\u4f4d\u7f6e\u548c\u4e4b\u524d\u7684\u4f4d\u7f6e\u5207\u6362\\nCommand+F12 \u6587\u4ef6\u7ed3\u6784\u5f39\u51fa\u5f0f\u83dc\u5355\\nalt+H \u7c7b\u7684\u5c42\u6b21\u7ed3\u6784\\nF2,shift+F2 \u5207\u6362\u5230\u4e0a\\\\\u4e0b\u4e00\u4e2a\u7a81\u51fa\u9519\u8bef\u7684\u4f4d\u7f6e\\nCommand+\u2191 \u8df3\u8f6c\u5230\u5bfc\u822a\u680f\\nF3 \u6dfb\u52a0\u4e66\u7b7e\\nalt+F3 \u6dfb\u52a0\u5e26\u52a9\u8bb0\u7684\u4e66\u7b7e\\nalt+1,alt+2\u2026 \u5207\u6362\u5230\u76f8\u5e94\u52a9\u8bb0\u7684\u4e66\u7b7e\u4f4d\u7f6e\\nCommand+F3 \u6253\u5f00\u4e66\u7b7e\u5217\u8868\\n```\\n\\n## VCS/\u672c\u5730\u5386\u53f2\u8bb0\u5f55\\n```html\\ncontrol+V \u6253\u5f00VST\u5c0f\u6d6e\u7a97\\nCommand+K \u63d0\u4ea4\u9879\u76ee\\nCommand+T \u66f4\u65b0\u9879\u76ee\\nalt+shift+C \u6253\u5f00\u6700\u8fd1\u4fee\u6539\u5217\u8868\\n```\\n\\n## \u641c\u7d22\u548c\u66ff\u6362\\n```html\\nCommand+F \u641c\u7d22\\nCommand+R \u66ff\u6362\\nCommand+G \u67e5\u627e\u4e0b\u4e00\u4e2a\\nCommand+shift+G \u67e5\u627e\u4e0b\u4e00\u4e2a\\nCommand+shift+F \u6309\u8def\u5f84\u641c\u7d22\\nCommand+shift+R \u6309\u8def\u5f84\u66ff\u6362\\n\u9009\u4e2d\u6587\u5b57\u7684\u641c\u7d22\\nCommand+F7 \u5411\u58f0\u660e\u7684\u5730\u65b9\u641c\u7d22\u5e76\u9009\u4e2d\\nCommand+shift+F7 \u6253\u5f00\u641c\u7d22\u6846\u8fdb\u884c\u641c\u7d22\\nCommand+alt+F7 \u6253\u5f00\u5c0f\u6d6e\u7a97\u663e\u793a\u641c\u7d22\u5217\u8868\\n\u5bf9\u9879\u76ee\u6587\u4ef6\u7684\u64cd\u4f5c\uff08\u91cd\u6784\uff09\\nF5 \u590d\u5236\u6587\u4ef6\u5230\u67d0\u4e2a\u76ee\u5f55\\nF6 \u79fb\u52a8\u6587\u4ef6\u5230\u67d0\u4e2a\u76ee\u5f55\\nCommand+delete \u5b89\u5168\u5220\u9664\\nshift+F6 \u91cd\u547d\u540d\\n```\\n\\n## \u5168\u5c40\u7684\\n```html\\n\u53cc\u51fbshift \u5f39\u51fa\u5c0f\u6d6e\u7a97\u641c\u7d22\u6240\u6709\\nCommand+\u5207\u6362\u9879\u76ee Command+shift+ \u53cd\u5411\u5207\u6362\u9879\u76ee\\nCommand+shift+A \u6574\u4e2a\u5de5\u7a0b\u7684\u67e5\u627e\u64cd\u4f5c\\nCommand+1,Command+2\u2026 \u6253\u5f00\u5404\u79cd\u5de5\u5177\u7a97\u53e3\\nalt+shift+F \u628a\u6587\u4ef6\u6dfb\u52a0\u5230\u6536\u85cf\u5939\\nalt+shift+I \u6253\u5f00\u9879\u76ee\u63cf\u8ff0\\nalt+~ \u5feb\u901f\u5207\u6362\u5f53\u524d\u8ba1\u5212\\nCommand+, \u8bbe\u7f6e\u7f16\u8f91\u5668\\nControl+Tab \u9009\u9879\u5361\u548c\u5de5\u5177\u7a97\u53e3\u4e4b\u95f4\u8fdb\u884c\u5207\u6362\\nalert+\u56de\u8f66 \u663e\u793anpm\u7248\u672c\u5347\u7ea7\u5217\u8868\\n```"},{"id":"first-blog","metadata":{"permalink":"/dk-blog/first-blog","editUrl":"https://github.com/dk-wuwei/dk-blog/tree/main/blog/2022-09-20-first-blog.md","source":"@site/blog/2022-09-20-first-blog.md","title":"Vue2\u89e3\u6790excel\u6570\u636e","description":"\u7528\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u4f7f\u7528 Vue2 + Web Worker + js-xlsx \u89e3\u6790 excel \u6570\u636e","date":"2022-09-20T00:00:00.000Z","formattedDate":"2022\u5e749\u670820\u65e5","tags":[{"label":"Vue2","permalink":"/dk-blog/tags/vue-2"},{"label":"ElementUI","permalink":"/dk-blog/tags/element-ui"}],"readingTime":7.415,"hasTruncateMarker":true,"authors":[{"name":"DK","title":"\u524d\u7aef\u5de5\u7a0b\u5e08","url":"https://github.com/dk-wuwei","imageURL":"https://avatars.githubusercontent.com/u/58164432?v=4","key":"DK"}],"frontMatter":{"slug":"first-blog","title":"Vue2\u89e3\u6790excel\u6570\u636e","authors":"DK","tags":["Vue2","ElementUI"]},"prevItem":{"title":"mac webstorm\u5feb\u6377\u952e","permalink":"/dk-blog/webstorm-shortcut-key"}},"content":"\u7528\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u4f7f\u7528 Vue2 + Web Worker + js-xlsx \u89e3\u6790 excel \u6570\u636e\\n\\n\x3c!--truncate--\x3e\\n\\n**\u672c\u6587\u91cd\u70b9\u5728\u4e8e\u5b9e\u73b0\u529f\u80fd\uff0c\u6ca1\u6709\u8fc7\u591a\u53bb\u5173\u6ce8\u5176\u4ed6\u3002** \u5c31\u60f3\u4f7f\u7528\u7684\u8bdd\u76f4\u63a5 cv \u5230\u81ea\u5df1\u7684\u9879\u76ee\u5373\u53ef\uff0c\u60f3\u6df1\u5165\u5b66\u4e60\u4e0b\u8fb9\u4e5f\u6709\u5b98\u65b9\u7f51\u5740\u81ea\u884c\u67e5\u770b\u54af \ud83c\udf7a\\n\\n\u7531[SheetJS](https://links.jianshu.com/go?to=https%3A%2F%2Fsheetjs.com%2F)\u51fa\u54c1\u7684`js-xlsx`\u662f\u4e00\u6b3e\u975e\u5e38\u65b9\u4fbf\u7684\u53ea\u9700\u8981\u7eaf JS \u5373\u53ef\u8bfb\u53d6\u548c\u5bfc\u51fa excel \u7684\u5de5\u5177\u5e93\uff0c\u529f\u80fd\u5f3a\u5927\uff0c\u652f\u6301\u683c\u5f0f\u4f17\u591a\uff0c\u652f\u6301 xls\u3001xlsx\u3001ods(\u4e00\u79cd OpenOffice \u4e13\u6709\u8868\u683c\u6587\u4ef6\u683c\u5f0f)\u7b49\u5341\u51e0\u79cd\u683c\u5f0f\u3002\u672c\u6587\u4ee5 xlsx \u683c\u5f0f\u4e3a\u4f8b\u3002github\uff1a[https://github.com/SheetJS/sheetjs](https://github.com/SheetJS/sheetjs)\\n\\n\u4e3a\u4ec0\u4e48\u4f7f\u7528 Web Worker \u5462\uff1f\u4e3a\u4e86\u52a0\u5feb\u89e3\u6790\u901f\u5ea6\uff0c\u63d0\u9ad8\u7528\u6237\u4f53\u9a8c\u5ea6 \ud83e\udd21\u3002Web Worker \u5177\u4f53\u4ecb\u7ecd\u770b\u962e\u8001\u5e08\u7684\u535a\u5ba2\u5c31\u597d \ud83d\ude00\\n[Web Worker \u4f7f\u7528\u6559\u7a0b - \u962e\u4e00\u5cf0\u7684\u7f51\u7edc\u65e5\u5fd7](http://www.ruanyifeng.com/blog/2018/07/web-worker.html)\\n\\n**\u672c\u6587\u914d\u5957 demo \u4ed3\u5e93\uff1a**\\n\\n**[https://gitee.com/ardeng/worker-xlsx.git](https://gitee.com/ardeng/worker-xlsx.git)**\\n\\n# \u6548\u679c\u6f14\u793a\\n\\n![\u6f14\u793a\u6548\u679c](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d17099415f4a465489d0671abada33d7~tplv-k3u1fbpfcp-watermark.image?)\\n\\n## HTML\\n\\n**\u666e\u666e\u901a\u901a\u3001\u7b80\u7b80\u5355\u5355\u7684 element ui \u4e0a\u4f20\u7ec4\u4ef6**\\n\\n```html\\n<el-upload\\n    ref=\\"input\\"\\n    action=\\"/\\"\\n    :show-file-list=\\"false\\"\\n    :auto-upload=\\"false\\"\\n    :on-change=\\"importExcel\\"\\n    type=\\"file\\"\\n>\\n    <el-button type=\\"primary\\">\u4e0a\u4f20</el-button>\\n</el-upload>\\n```\\n\\n## JS \u90e8\u5206\\n\\n### \u65e0 Web Worker \u7248\\n\\nWorker \u7ebf\u7a0b\u4e00\u65e6\u65b0\u5efa\u6210\u529f\uff0c\u5c31\u4f1a\u59cb\u7ec8\u8fd0\u884c\uff0c\u4e0d\u4f1a\u88ab\u4e3b\u7ebf\u7a0b\u4e0a\u7684\u6d3b\u52a8\uff08\u6bd4\u5982\u7528\u6237\u70b9\u51fb\u6309\u94ae\u3001\u63d0\u4ea4\u8868\u5355\uff09\u6253\u65ad\u3002\u8fd9\u6837\u6709\u5229\u4e8e\u968f\u65f6\u54cd\u5e94\u4e3b\u7ebf\u7a0b\u7684\u901a\u4fe1\u3002\u4f46\u662f\uff0c\u8fd9\u4e5f\u9020\u6210\u4e86 Worker \u6bd4\u8f83\u8017\u8d39\u8d44\u6e90\uff0c\u4e0d\u5e94\u8be5\u8fc7\u5ea6\u4f7f\u7528\uff0c\u800c\u4e14\u4e00\u65e6\u4f7f\u7528\u5b8c\u6bd5\uff0c\u5c31\u5e94\u8be5\u5173\u95ed\u3002\\n\\nWeb Worker \u6709\u4ee5\u4e0b\u51e0\u4e2a\u4f7f\u7528\u6ce8\u610f\u70b9\u3002\\n\\n1. **\u540c\u6e90\u9650\u5236** \u5206\u914d\u7ed9 Worker \u7ebf\u7a0b\u8fd0\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u5fc5\u987b\u4e0e\u4e3b\u7ebf\u7a0b\u7684\u811a\u672c\u6587\u4ef6\u540c\u6e90\u3002\\n\\n2. **DOM \u9650\u5236** Worker \u7ebf\u7a0b\u6240\u5728\u7684\u5168\u5c40\u5bf9\u8c61\uff0c\u4e0e\u4e3b\u7ebf\u7a0b\u4e0d\u4e00\u6837\uff0c\u65e0\u6cd5\u8bfb\u53d6\u4e3b\u7ebf\u7a0b\u6240\u5728\u7f51\u9875\u7684 DOM \u5bf9\u8c61\uff0c\u4e5f\u65e0\u6cd5\u4f7f\u7528`document`\u3001`window`\u3001`parent`\u8fd9\u4e9b\u5bf9\u8c61\u3002\u4f46\u662f\uff0cWorker \u7ebf\u7a0b\u53ef\u4ee5`navigator`\u5bf9\u8c61\u548c`location`\u5bf9\u8c61\u3002\\n\\n3. **\u901a\u4fe1\u8054\u7cfb** Worker \u7ebf\u7a0b\u548c\u4e3b\u7ebf\u7a0b\u4e0d\u5728\u540c\u4e00\u4e2a\u4e0a\u4e0b\u6587\u73af\u5883\uff0c\u5b83\u4eec\u4e0d\u80fd\u76f4\u63a5\u901a\u4fe1\uff0c\u5fc5\u987b\u901a\u8fc7\u6d88\u606f\u5b8c\u6210\u3002\\n\\n4. **\u811a\u672c\u9650\u5236** Worker \u7ebf\u7a0b\u4e0d\u80fd\u6267\u884c`alert()`\u65b9\u6cd5\u548c`confirm()`\u65b9\u6cd5\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 XMLHttpRequest \u5bf9\u8c61\u53d1\u51fa AJAX \u8bf7\u6c42\u3002\\n\\n5. **\u6587\u4ef6\u9650\u5236** Worker \u7ebf\u7a0b\u65e0\u6cd5\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\uff0c\u5373\u4e0d\u80fd\u6253\u5f00\u672c\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\uff08`file://`\uff09\uff0c\u5b83\u6240\u52a0\u8f7d\u7684\u811a\u672c\uff0c\u5fc5\u987b\u6765\u81ea\u7f51\u7edc\u3002\\n\\n**\u7531\u4e8e\u4ee5\u4e0a\u7684\u9650\u5236\uff0c\u6240\u4ee5\u4e0d\u60f3\u641e Worker \u4e5f\u53ef\u4ee5\u3002** \u76f4\u63a5\u89e3\u6790\u6587\u4ef6\u5bf9\u8c61 \u8f6c\u6362\u6570\u636e\u5373\u53ef\u3002\\n\\n```js\\nimportExcel(file) {\\n  // \u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u4e3aexcel\\n  if (!/\\\\.(xlsx|xls|csv)$/.test(file.name)) {\\n    alert(\\"\u683c\u5f0f\u9519\u8bef\uff01\u8bf7\u91cd\u65b0\u9009\u62e9\\")\\n    return\\n  }\\n  this.fileToExcel(file).then(tabJson => {\\n    // \u8fd9\u91cc\u62ff\u5230excel\u7684\u6570\u636e\\n    console.log(tabJson)\\n  })\\n},\\n// excel\u6570\u636e\u8f6c\u4e3ajson\u6570\u7ec4\\nfileToExcel(file) {\\n  // \u4e0d\u4f7f\u7528 Promise \u4e5f\u53ef\u4ee5 \u53ea\u662f\u628a\u8bfb\u6587\u4ef6\u505a\u6210\u5f02\u6b65\u66f4\u5408\u7406\\n  return new Promise(function (resolve, reject) {\\n    const reader = new FileReader()\\n    reader.onload = function (e) {\\n        // \u62ff\u5230file\u6570\u636e\\n        const result = e.target.result\\n        // XLSX \u89e3\u6790\u7684\u914d\u7f6e  type: \'binary\' \u5fc5\u5199\\n        const excelData = XLSX.read(result, { type: \'binary\' })\\n        // \u6ce8\u610f\u8981\u52a0 { header: 1 }, \u6b64\u914d\u7f6e\u9879 \u53ef\u751f\u6210\u4e8c\u7ef4\u6570\u7ec4\\n        const data = XLSX.utils.sheet_to_json(excelData.Sheets[excelData.SheetNames[0]],\\n                      { header: 1 }) //! \u8bfb\u53d6\u53bb\u9664\u5de5\u4f5c\u7c3f\u4e2d\u7684\u6570\u636e\\n        resolve(data)\\n      }\\n      // \u8c03\u7528\u65b9\u6cd5  \u8bfb\u53d6\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\\n      reader.readAsBinaryString(file.raw)\\n    })\\n  }\\n```\\n\\n### Web Worker \u7248\\n\\n**\u60f3\u7528 Worker \u4e00\u4e9b\u524d\u7f6e\u5de5\u4f5c\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684**\\n\\n1. \u4e0b\u8f7d worker-loader\\n\\n```shell\\nnpm i -D worker-loader\\n```\\n\\n2. vue.config.js \u4e2d\u914d\u7f6e loader\\n\\n```js\\n// \u8bbe\u7f6e\u89e3\u6790\u4ee5worker.js \u7ed3\u5c3e\u7684\u6587\u4ef6\u4f7f\u7528worker-loader \u89e3\u6790\\nchainWebpack: (config) => {\\n  config.module\\n    .rule(\\"worker\\")\\n    .test(/\\\\.worker\\\\.js$/)\\n    .use(\\"worker-loader\\")\\n    .loader(\\"worker-loader\\")\\n    .options({ inline: \\"fallback\\" });\\n};\\n```\\n\\n**\u6b63\u5f0f\u8fdb\u5165\u4f7f\u7528 Web Worker**\\n\\n\u5c01\u88c5\u4e00\u4e0b Web Worker \u547d\u540d\u89c4\u5219\u5982\u4e0b\uff1axxx.worker.js\\n\\n\u4e0b\u9762\u4ee3\u7801\u4e2d\uff0c`self`\u4ee3\u8868\u5b50\u7ebf\u7a0b\u81ea\u8eab\uff0c\u5373\u5b50\u7ebf\u7a0b\u7684\u5168\u5c40\u5bf9\u8c61\u3002\\n\\n```js\\n// src\\\\utils\\\\excel.worker.js\\n\\nimport XLSX from \\"xlsx\\";\\n\\n/**\\n * \u5904\u7406\u9519\u8bef\u7684\u51fd\u6570 \u4e3b\u7ebf\u7a0b\u53ef\u4ee5\u76d1\u542c Worker \u662f\u5426\u53d1\u751f\u9519\u8bef\u3002\\n * \u5982\u679c\u53d1\u751f\u9519\u8bef\uff0cWorker \u4f1a\u89e6\u53d1\u4e3b\u7ebf\u7a0b\u7684`error`\u4e8b\u4ef6\u3002\\n */\\nconst ERROR = () => {\\n  // \u53d1\u9001\u9519\u8bef\u4fe1\u606f\\n  self.postMessage({ message: \\"error\\", data: [] });\\n\\n  // `self.close()`\u7528\u4e8e\u5728 Worker \u5185\u90e8\u5173\u95ed\u81ea\u8eab\u3002\\n  self.close();\\n};\\n\\n// \u9519\u8bef\u5904\u7406\\nself.addEventListener(\\"error\\", (event) => {\\n  ERROR();\\n\\n  // \u8f93\u51fa\u9519\u8bef\u4fe1\u606f\\n  console.log(\\n    \\"ERROR: Line \\",\\n    event.lineno,\\n    \\" in \\",\\n    event.filename,\\n    \\": \\",\\n    event.message\\n  );\\n});\\n\\n/**\\n * @description: Worker \u7ebf\u7a0b\u5185\u90e8\u9700\u8981\u6709\u4e00\u4e2a\u76d1\u542c\u51fd\u6570\uff0c\u76d1\u542c`message`\u4e8b\u4ef6\u3002 \u5de5\u4f5c\u7ebf\u7a0b\u63a5\u6536\u5230\u4e3b\u7ebf\u7a0b\u7684\u6d88\u606f\\n * @param {object} event event.data  \u83b7\u53d6\u5230\u4e3b\u7ebf\u7a0b\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\\n */\\nself.addEventListener(\\n  \\"message\\",\\n  async (event) => {\\n    // \u5411\u4e3b\u7ebf\u7a0b\u53d1\u9001\u6d88\u606f\\n    // postMessage(event.data);\\n\\n    // \u89e3\u6790excel\u6570\u636e\\n    parsingExcel(event.data);\\n  },\\n  false\\n);\\n\\n/**\\n * @description: \u89e3\u6790excel\u6570\u636e\\n * @param {object} data.excelFileData \u6587\u4ef6\u6570\u636e\\n * @param {object} data.config \u914d\u7f6e\u4fe1\u606f\\n */\\nconst parsingExcel = (data) => {\\n  try {\\n    // \u6ce8\u610f { header: 1 }, \u6b64\u914d\u7f6e\u9879 \u53ef\u751f\u6210\u4e8c\u7ef4\u6570\u7ec4\\n    const { excelFileData, config = { header: 1 } } = data;\\n\\n    // \u521b\u5efa\u5b9e\u4f8b\u5316\u5bf9\u8c61\\n    const reader = new FileReader();\\n\\n    // \u5904\u7406\u6570\u636e\\n    reader.onload = function (e) {\\n      // \u62ff\u5230file\u6570\u636e\\n      const result = e.target.result;\\n      const excelData = XLSX.read(result, { type: \\"binary\\" });\\n      const data = XLSX.utils.sheet_to_json(\\n        excelData.Sheets[excelData.SheetNames[0]],\\n        config\\n      ); //! \u8bfb\u53d6\u53bb\u9664\u5de5\u4f5c\u7c3f\u4e2d\u7684\u6570\u636e\\n\\n      // \u53d1\u9001\u6d88\u606f\\n      self.postMessage({ message: \\"success\\", data });\\n    };\\n    // \u8c03\u7528\u65b9\u6cd5  \u8bfb\u53d6\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\\n    reader.readAsBinaryString(excelFileData.raw);\\n  } catch (err) {\\n    ERROR();\\n    console.log(\\"\u89e3\u6790excel\u6570\u636e\u65f6 catch\u5230\u7684\u9519\u8bef===>\\", err);\\n  }\\n};\\n```\\n\\n**\u4f7f\u7528**\\n\\n\u5f15\u5165\u6587\u4ef6\\n\\n```js\\nimport Worker from \\"@/utils/excel.worker.js\\";\\n```\\n\\n\u4e1a\u52a1\u76f8\u5173\u7684\u903b\u8f91\\n\\n```js\\nimportExcel(file) {\\n  if (!/\\\\.(xlsx|xls|csv)$/.test(file.name)) {\\n    alert(\\"\u683c\u5f0f\u9519\u8bef\uff01\u8bf7\u91cd\u65b0\u9009\u62e9\\")\\n    return;\\n  }\\n\\n  // \u521b\u5efa\u5b9e\u5217\\n  const worker = new Worker()\\n\\n  // \u4e3b\u7ebf\u7a0b\u8c03\u7528`worker.postMessage()`\u65b9\u6cd5\uff0c\u5411 Worker \u53d1\u6d88\u606f\\n  worker.postMessage({\\n    excelFileData: file,\\n    config: { header: 1 }\\n  })\\n\\n // \u4e3b\u7ebf\u7a0b\u901a\u8fc7`worker.onmessage`\u6307\u5b9a\u76d1\u542c\u51fd\u6570\uff0c\u63a5\u6536\u5b50\u7ebf\u7a0b\u53d1\u56de\u6765\u7684\u6d88\u606f\\n  worker.onmessage = (event) => {\\n    const { message, data } = event.data\\n    if (message === \'success\') {\\n      // data\u662f\u4e2a\u4e8c\u7ef4\u6570\u7ec4 \u8868\u5934\u5728\u4e0a\u8fb9\\n      console.log(data)\\n      // Worker \u5b8c\u6210\u4efb\u52a1\u4ee5\u540e\uff0c\u4e3b\u7ebf\u7a0b\u5c31\u53ef\u4ee5\u628a\u5b83\u5173\u6389\u3002\\n      worker.terminate()\\n    }\\n  }\\n}\\n```\\n\\n# \u53ef\u80fd\u9047\u5230\u7684\u95ee\u9898\\n\\n1. `npm run dev`\xa0 \u542f\u52a8\u4e0d\u4e86\uff0c\u5e76\u4e14 webpack \u62a5\u9519\uff1a\u68c0\u67e5\u4e0b \xa0`webpack`\xa0`worker-loader`\xa0 \u7684\u7248\u672c\u3002\\n2. \u63a7\u5236\u53f0\u62a5\u9519\u5305\u542b \xa0`not a function`\xa0 \u6216 \xa0`not a constructor`\uff1a\u68c0\u67e5\u4e0b webpck \u914d\u7f6e\u3002\u6700\u597d\u662f\u67e5\u770b\u82f1\u6587\u6587\u6863 \xa0[webpack](https://webpack.js.org/)\uff0c\u56e0\u4e3a\u4e2d\u6587\u6587\u6863\u66f4\u65b0\u4e0d\u53ca\u65f6\u3002\\n3. \u63a7\u5236\u53f0\u62a5\u9519 \xa0`window is not defined`\uff1a\u6539\u6210 \xa0`self`\xa0 \u8bd5\u8bd5\u3002\u53c2\u8003 \xa0[Webpack worker-loader - import doesn\u2019t work](https://stackoverflow.com/questions/38747706/webpack-worker-loader-import-doesnt-work)"}]}')}}]);